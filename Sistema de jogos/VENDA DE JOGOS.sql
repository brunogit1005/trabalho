DROP DATABASE IF EXISTS JOGOS;
CREATE DATABASE IF NOT EXISTS JOGOS;
USE JOGOS;

CREATE TABLE IF NOT EXISTS ADMINISTRADOR (
    ID_ADM INT NOT NULL PRIMARY KEY,
    TELEFONE INT(25),
    CIDADE VARCHAR(25),
    RG VARCHAR (15),
    CPF INT (11),
    EMAIL VARCHAR(30),
    NOME VARCHAR(30),
    DATA_NASC DATE 
    
);

CREATE TABLE IF NOT EXISTS JOGOS (
    ID_JOGO INT NOT NULL PRIMARY KEY,
    NOME_JOGO VARCHAR(40),
    CLASS_INDICATIVA INT,
    PRECO FLOAT (22, 2),
    LINGUAGEM VARCHAR(20),
    AVALIACAO INT (2),
    EMPRESA VARCHAR(40)
    
);

CREATE TABLE IF NOT EXISTS COMPRA (
    ID_COMPRA INT NOT NULL PRIMARY KEY,
    DATA_COMPRA DATE,
    NOME_USUARIO VARCHAR(12)
);

CREATE TABLE IF NOT EXISTS USUARIO (
    ID_USUARIO INT NOT NULL PRIMARY KEY,
	NOME VARCHAR(35),
    DATA_NASC DATE,
	RG VARCHAR (15),
    CPF INT(11),
    CIDADE VARCHAR(25),
    ENDERECO VARCHAR(40),
    TELEFONE INT(25),
    EMAIL VARCHAR(30),
    COD_DENUNCIA INT,
	COD_COMPRA INT,
    FOREIGN KEY (COD_DENUNCIA)
		REFERENCES DENUNCIA (ID_DENUNCIA)
        ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY (COD_COMPRA)
		REFERENCES COMPRA (ID_COMPRA)
        ON UPDATE CASCADE ON DELETE CASCADE 
);

CREATE TABLE IF NOT EXISTS CARRINHO (
    ID_CARRINHO INT NOT NULL PRIMARY KEY,
    NUM_CARTAO INT(15),
    MODO_PAGAMENTO VARCHAR(20),
    COD_JOGO INT,
    COD_USUARIO INT,
    COD_COMPRA INT,
    FOREIGN KEY (COD_USUARIO)
        REFERENCES USUARIO (ID_USUARIO)
        ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY (COD_COMPRA)
		REFERENCES COMPRA (ID_COMPRA)
        ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(COD_JOGO)
		REFERENCES JOGOS (ID_JOGO)
        ON UPDATE CASCADE ON DELETE CASCADE
        
);

CREATE TABLE IF NOT EXISTS DENUNCIA (
    ID_DENUNCIA INT NOT NULL PRIMARY KEY,
    COD_USUARIO INT,
    COD_ADM INT,
    SITUACAO VARCHAR(40),
    FOREIGN KEY (COD_USUARIO)
        REFERENCES USUARIO (ID_USUARIO)
        ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (COD_ADM)
        REFERENCES ADMINISTRADOR (ID_ADM)
        ON UPDATE CASCADE ON DELETE CASCADE
);

        
CREATE TABLE IF NOT EXISTS JOGOS_CARRINHO (
    COD_JOGO INT NOT NULL,
    COD_CARRINHO INT NOT NULL,
    PRIMARY KEY (COD_JOGO , COD_CARRINHO),
    FOREIGN KEY (COD_JOGO)
        REFERENCES JOGOS (ID_JOGO)
        ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (COD_CARRINHO)
        REFERENCES CARRINHO (ID_CARRINHO)
        ON UPDATE CASCADE ON DELETE CASCADE
    
);
SHOW TABLES;



INSERT INTO ADMINISTRADOR VALUES (1,3232236,'ARARAQUARA','1234556',123456789,'ANDRE@PAULO','ANDRE','2001-10-27');
INSERT INTO ADMINISTRADOR VALUES (2,123456789,'ARARAQUARA','987456321',852136497,'CARLOS@GMAIL','CARLOS','2000-09-27');
INSERT INTO ADMINISTRADOR VALUES (3,456789123,'SAO PAULO','235689741',235689741,'ALBERTO@GMAIL','ALBERTO','1999-08-7');

SELECT *
FROM ADMINISTRADOR;


INSERT INTO JOGOS VALUES (1,'DARK SOULS',16,100.00,'PORTUGUES',10.0,'FROMSOFTWARE');
INSERT INTO JOGOS VALUES (2,'DARK SOULS 2',16,60.00,'PORTUGUES',6,'FROMSOFTWARE');
INSERT INTO JOGOS VALUES (3,'DARK SOULS 3',16,150.00,'PORTUGUES',10,'FROMSOFTWARE');

SELECT *
FROM JOGOS;


INSERT INTO COMPRA VALUES (14,'2019-10-30','JOAO');
INSERT INTO COMPRA VALUES (6,'2019-09-30','BRUNO');
INSERT INTO COMPRA VALUES (15,'2019-08-30','EDUARDO');

SELECT *
FROM COMPRA;


INSERT INTO USUARIO VALUES (25,'JOAO','2001-10-31','1234567890',98765432,'ARARAQUARA','RUA JOSE DE ARRUDA FALCAO',988332832,'JOAO@GMAIL',12,35);
INSERT INTO USUARIO VALUES (5,'EDUARDO','2010-11-30','79854346',54343587,'ARARAQUARA','JARDIM SAO RAFAEL',64545483,'EDUARDO@GMAIL',2,5);
INSERT INTO USUARIO VALUES (45,'BRUNO','2002-10-30','54231319',472354648,'ARARAQUARA','RUA TRAB DO FON',97854334,'BRUNO@GMAIL',1,3);

SELECT *
FROM USUARIO;


INSERT INTO DENUNCIA VALUES (54,25,1,'SENDO ANALISADO');
INSERT INTO DENUNCIA VALUES (35,5,2,'ANALISADO');
INSERT INTO DENUNCIA VALUES (63,45,3,'ANALISADO');

SELECT * 
FROM DENUNCIA;

INSERT INTO CARRINHO VALUES (100,4567873,'DEBITO',1,25,14);
INSERT INTO CARRINHO VALUES (125,3522314,'CREDITO',2,5,6);
INSERT INTO CARRINHO VALUES (145,4567873,'CRETIDO',3,45,15);
SELECT *
FROM CARRINHO;

INSERT INTO JOGOS_CARRINHO VALUES (1,100);
INSERT INTO JOGOS_CARRINHO VALUES (2,125);
INSERT INTO JOGOS_CARRINHO VALUES (3,145);
SELECT *
FROM JOGOS_CARRINHO;

SELECT 
    NOME, SITUACAO
FROM
    DENUNCIA
        INNER JOIN
    USUARIO ON DENUNCIA.COD_USUARIO = USUARIO.ID_USUARIO;
    
SELECT 
    NOME, SITUACAO
FROM
    USUARIO
        INNER JOIN
    DENUNCIA ON USUARIO.ID_USUARIO = DENUNCIA.COD_USUARIO;
    
SELECT 
    NOME_JOGO,MODO_PAGAMENTO,DATA_COMPRA,NOME_USUARIO
FROM
    CARRINHO
        INNER JOIN
    JOGOS ON CARRINHO.COD_JOGO = JOGOS.ID_JOGO
		INNER JOIN
	COMPRA ON CARRINHO.COD_COMPRA = COMPRA.ID_COMPRA
		INNER JOIN 
	USUARIO ON CARRINHO.COD_USUARIO = USUARIO.ID_USUARIO;
    
    